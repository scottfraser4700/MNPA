R1 = 1;
C = .25;
R2 = 2;
L = 0.2;
R3 = 10;
a = 100;
R4 = 0.1;
R5 = 1000;

g1 = 1/R1;
g2 = 1/R2;
g3 = 1/R3;
g4 = 1/R4;
g5 = 1/R5;



G = [g1 -g1 0 0 0 1 0 ;
    -g1 g1+g2 0 0 0 0 1;
    0 0 g3 0 0 0 -1;
    0 0 -a*g3*(g4+g5) g4 -g4 0 0 ;
    0 0 0 -g4 g4+g5 0 0 ;
    0 1 -1 0 0 0 0 ;
    1 0 0 0 0 0 0];

C = [C -C 0 0 0 0 0;
    -C C 0 0 0 0 0;
     0 0 0 0 0 0 0;
     0 0 0 0 0 0 0;
     0 0 0 0 0 0 0;
     0 0 0 0 0 0 -L;
     0 0 0 0 0 0 0];

 G = [g1 -g1 0 0 0 1 0 ;
        -g1 g1+g2 0 0 0 0 1;
        0 0 g3 0 0 0 -1;
        0 0 0 1 0 0 -a;
        0 0 0 -g4 g4+g5 0 0 ;
        0 1 -1 0 0 0 0 ;
        1 0 0 0 0 0 0];
    
for w=1:100
    %sweep from -10 to 10
    
    F = [0 0 0 0 0 0 1]';
       
    
    V = (G+1i*w*C)\F;
    
    V5(w) = V(5);
%     V5(vin+11)=V(5);
%     V3(vin+11)=V(3);

end
x = linspace(1,100,100);
plot(real(V5))
% hold on
% plot(x,V3)


